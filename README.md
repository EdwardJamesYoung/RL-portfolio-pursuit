# RL for Portfolio Pursuit

The codebase accompanies our paper (ARCHIVE LINK) applying reinforcement learning ideas to portfolio pursuit in the context of insurance markets. It is designed to allow other research to build on our research, replicate our results, and use the market environment for their own work. 

## Structure of the codebase

### The run experiment notebook 
The run experiment notebook allows a user to run specific experiments using the environment. It allows users to define a grid of model hyperparameters to perform a grid search over, and then run a number of trials (with pre-specified random seeds) to assess performance for those hyperparameters. The functions in this notebook also handle the interaction between insurers and the market 

### Config file
The config.py file contains dataclasses used to set hyperparameters for experiments, such as the length of an episode, the number of insurers in the market, and the number of training and testing episodes. Other hyperparameters for specific models used by insurers can be passed in when running experiments 

### Market file
The market.py file contains the Market class. This handles the interactions between insurers and customers. Customers are generated by the market. Their details are sent to insurers, who each make the customer an offer. On the basis of that, the customer makes a decision about which offer to accept. The market object also tracks various statistics related to market interactions. 

### Customer file
The customer.py file contains the Customer class. When initialised, the customer's features are drawn from a complex generative distribution. Features include occupation, location, age, marital status, income, and car valuation. These depend on each other in a realistic manner. Customers also have a method for making decisions, where they take in a collection of offers made by various insurance firms, and choose which offer to accept (or whether to reject all offers). Selection is random, with a preference towards lower offers.  

### Insurer file

The bulk of the code is found in the insurer file. We go into detail about how our insurance agents operate in our paper (ARCHIEVE LINK). Here we briefly explain some key steps. 

Insurers have three core models:
1. *Market models* - these predict the behaviour of other firms within the market, for new customers.
2. *Conversion models* - these predict the likelihood of a customer accepting a given offers, given the other market behaviour.
3. *Bidding models* - these tell the insurer which offer to take for a new customer. 
These models are all trained using data that the insurer generates during market interactions. 

## License

This work is licensed under a [Creative Commons Attribution-NonCommercial 4.0 International License](https://creativecommons.org/licenses/by-nc/4.0/).
